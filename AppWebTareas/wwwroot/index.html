<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AppWebTareas</title>
    <base href="/AppWeb" />
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="AppWebTareas.styles.css" rel="stylesheet" />
</head>

<body>
    <div id="app">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%" />
            <circle r="40%" cx="50%" cy="50%" />
        </svg>
        <div class="loading-progress-text"></div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="." class="reload">Reload</a>
        <span class="dismiss">üóô</span>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>
        // Sistema de sonidos para Blazor WASM
        let audioContext = null;
        let audioInitialized = false;

        function ensureAudioContext() {
            if (!audioInitialized) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    audioInitialized = true;
                    console.log("‚úÖ AudioContext initialized");
                } catch (error) {
                    console.log("‚ùå Failed to initialize AudioContext:", error);
                    return false;
                }
            }
            return true;
        }

        function playTone(frequency, duration, volume = 0.1) {
            if (!ensureAudioContext()) return false;

            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.type = 'sine';
                oscillator.frequency.value = frequency;

                gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration / 1000);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration / 1000);

                return true;
            } catch (error) {
                console.log("‚ùå Error playing tone:", error);
                return false;
            }
        }

        // Funciones espec√≠ficas
        window.playScratchSound = function () {
            console.log("üéØ Playing SCRATCH sound");
            return playTone(150, 300, 0.1);
        };

        window.playAddSound = function () {
            console.log("üéØ Playing ADD sound");
            return playTone(523.25, 200, 0.08);
        };

        window.playDeleteSound = function () {
            console.log("üéØ Playing DELETE sound");
            return playTone(100, 400, 0.12);
        };

        window.playPaperSound = function () {
            console.log("üéØ Playing PAPER sound");
            return playTone(300, 150, 0.06);
        };

        // Inicializar audio en la primera interacci√≥n
        document.addEventListener('click', function () {
            ensureAudioContext();
        }, { once: true });

        console.log("üéµ Sound system ready for Blazor WASM");
    </script>
</body>

</html>
